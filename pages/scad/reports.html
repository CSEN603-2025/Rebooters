<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports | SCAD System</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css">
    <style>
        /* Add new styles for comment section */
        .comments-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #d40000;
        }
        
        .comments-list {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        
        .comment-item {
            padding: 10px;
            margin-bottom: 10px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .comment-meta {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .comment-author {
            font-weight: bold;
            color: #d40000;
        }
        
        .comment-date {
            color: #999;
        }
        
        .comment-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            margin-bottom: 10px;
        }
        
        /* Hide status change buttons */
        .status-actions {
            display: none;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <img src="../../assets/images/guc-logo.png" alt="SCAD Logo" class="logo">
                <span class="system-name">GUC Internship System</span>
            </div>
            <div class="nav-menu">
                <a href="notifications.html" class="nav-link"><i class="fas fa-bell"></i><span class="notification-badge">5</span></a>
                <a href="#" class="nav-link logout-btn" id="logout-btn"><i class="fas fa-sign-out-alt"></i></a>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="user-profile">
                <img src="../../assets/images/guc-logo.png" alt="Admin Avatar" class="avatar">
                <div class="profile-status">
                    <span class="status-badge admin">SCAD Office</span>
                </div>
                <h3>Admin User</h3>
                <p>System Administrator</p>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="dashboard.html" ><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="companies.html" ><i class="fas fa-building"></i> Company Applications</a></li>
                    <li><a href="students.html"><i class="fas fa-users"></i> Student Management</a></li>
                    <li><a href="reports.html" class="active"><i class="fas fa-file-alt"></i> Internship Reports</a></li>
                    <li><a href="appointments.html"><i class="fas fa-calendar-alt"></i> Appointments</a></li>
                    <li><a href="internships.html" ><i class="fas fa-briefcase"></i> Available Internships</a></li>
                    <li><a href="workshops.html"><i class="fas fa-chalkboard-teacher"></i> Workshops</a></li>
                </ul>
            </nav>
        </aside>
        <main class="main-content">
            <div class="dashboard-header">
            <h1>Internship Reports & Analytics</h1>
            <div class="header-actions">
                <button class="btn btn-primary" id="export-reports-btn"><i class="fas fa-download"></i> Export All</button>
                <button class="btn btn-secondary" id="refresh-reports-btn"><i class="fas fa-sync-alt"></i> Refresh</button>
                <button class="btn btn-info" id="generate-report-btn"><i class="fas fa-file-pdf"></i> Generate Analytics Report</button>
            </div>
        </div>
        <div class="dashboard-section">
            <div class="dashboard-section">
                <!-- Filter Controls -->
            <div class="filter-controls">
                <div class="search-group">
                    <i class="fas fa-search"></i>
                    <input type="text" id="report-search" class="form-control" placeholder="Search by student, company, or ID...">
                </div>
                
                <div class="filter-group">
                    <label for="status-filter">Status:</label>
                    <select id="status-filter" class="form-control">
                        <option value="all">All Statuses</option>
                        <option value="pending">Pending</option>
                        <option value="accepted">Accepted</option>
                        <option value="flagged">Flagged</option>
                        <option value="rejected">Rejected</option>
                    </select>
                
                    <label for="major-filter">Major:</label>
                    <select id="major-filter" class="form-control">
                        <option value="all">All Majors</option>
                        <option value="Computer Science">Computer Science</option>
                        <option value="Business">Business</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Design">Design</option>
                        <option value="Architecture">Architecture</option>
                        <option value="Pharmacy">Pharmacy</option>
                    </select>
                
                    <label for="cycle-filter">Cycle:</label>
                    <select id="cycle-filter" class="form-control">
                        <option value="all">All Cycles</option>
                        <option value="Summer 2023">Summer 2023</option>
                        <option value="Winter 2023">Winter 2023</option>
                        <option value="Summer 2024">Summer 2024</option>
                    </select>
                </div>
                
                <button class="btn btn-secondary" id="reset-filters">
                    <i class="fas fa-undo"></i> Reset
                </button>
            </div>
                <div class="table-responsive">
                    <table class="reports-table" id="reports-table">
                        <thead>
                            <tr>
                                <th class="col-student">Student</th>
                                <th class="col-id">Student ID</th>
                                <th class="col-major">Major</th>
                                <th class="col-company">Company</th>
                                <th class="col-cycle">Cycle</th>
                                <th class="col-date">Submitted</th>
                                <th class="col-status">Status</th>
                                <th class="col-grade">Grade</th>
                                <th class="col-actions">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Reports will be loaded dynamically -->
                        </tbody>
                    </table>
                </div>
                <div class="pagination">
                    <button class="btn btn-secondary" id="prev-page" disabled>Previous</button>
                    <span class="page-info" id="page-info">Page 1 of 1</span>
                    <button class="btn btn-secondary" id="next-page">Next</button>
                </div>
            </div>
            <!-- Compact Statistics Section -->
        <div class="compact-stats">
            <div class="stat-filter">
        <label for="stats-cycle-filter">Show Statistics For:</label>
        <select id="stats-cycle-filter" class="form-control">
            <option value="all">All Cycles</option>
            <option value="Summer 2023">Summer 2023</option>
            <option value="Winter 2023">Winter 2023</option>
            <option value="Summer 2024">Summer 2024</option>
        </select>
    </div>
            <div class="stat-card-small">
        <h3><i class="fas fa-chart-pie"></i> Report Status <span id="cycle-stats-title"></span></h3>
        <div class="mini-chart">
            <canvas id="miniStatusChart"></canvas>
        </div>
        <div class="stat-summary-small">
            <div><span class="badge accepted"></span> Accepted: <span id="mini-accepted-count">0</span></div>
            <div><span class="badge pending"></span> Pending: <span id="mini-pending-count">0</span></div>
            <div><span class="badge flagged"></span> Flagged: <span id="mini-flagged-count">0</span></div>
            <div><span class="badge rejected"></span> Rejected: <span id="mini-rejected-count">0</span></div>
        </div>
    </div>
            
            <!-- Top Companies Card -->
            <div class="stat-card-small">
                <h3><i class="fas fa-building"></i> Top Companies</h3>
                <div class="top-list-small" id="mini-top-companies-list">
                    <!-- Dynamically populated -->
                </div>
                <div class="stat-summary-small">
                    <span>Sorted by internship count</span>
                </div>
            </div>
            
            <!-- Quick Stats Card -->
            <div class="stat-card-small">
                <h3><i class="fas fa-tachometer-alt"></i> Quick Stats</h3>
                <div class="stat-summary-small">
                    <div>Total Reports: <span id="total-reports">0</span></div>
                    <div>Avg. Review Time: <span id="mini-review-time">0</span> days</div>
                    <div>Completion Rate: <span id="mini-completion-rate">0%</span></div>
                    <div>Top Course: <span id="mini-top-course">-</span></div>
                </div>
            </div>
  
                
            </div>
        </div>

            

            
        </main>
    </div>

    <!-- Report Details Modal -->
    <div class="modal" id="report-details-modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="modal-report-title">Internship Report Details</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="report-details-grid">
                    <div class="student-info">
                        <h4>Student Information</h4>
                        <div class="detail-section">
                            <span class="detail-label">Student Name:</span>
                            <span class="detail-value" id="detail-student-name">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Student ID:</span>
                            <span class="detail-value" id="detail-student-id">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Major:</span>
                            <span class="detail-value" id="detail-major">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Faculty Advisor:</span>
                            <span class="detail-value" id="detail-advisor">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value" id="detail-email">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value" id="detail-phone">-</span>
                        </div>
                    </div>
                    
                    <div class="internship-info">
                        <h4>Internship Details</h4>
                        <div class="detail-section">
                            <span class="detail-label">Company:</span>
                            <span class="detail-value" id="detail-company">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Position:</span>
                            <span class="detail-value" id="detail-position">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Start Date:</span>
                            <span class="detail-value" id="detail-start-date">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">End Date:</span>
                            <span class="detail-value" id="detail-end-date">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Supervisor:</span>
                            <span class="detail-value" id="detail-supervisor">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Supervisor Email:</span>
                            <span class="detail-value" id="detail-supervisor-email">-</span>
                        </div>
                    </div>
                    
                    <div class="report-metadata">
                        <h4>Report Information</h4>
                        <div class="detail-section">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value"><span class="status-badge" id="detail-status">-</span></span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Submitted:</span>
                            <span class="detail-value" id="detail-submitted">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Grade:</span>
                            <span class="detail-value" id="detail-grade">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Evaluation Score:</span>
                            <span class="detail-value" id="detail-score">-</span>
                        </div>
                        <div class="detail-section">
                            <span class="detail-label">Internship Cycle:</span>
                            <span class="detail-value" id="detail-cycle">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="tabs">
                    <button class="tab-btn active" data-tab="report-content">Internship Report</button>
                    <button class="tab-btn" data-tab="evaluation-content">Evaluation Report</button>
                </div>
                
                <div class="tab-content active" id="report-content">
                    <div id="report-content-text">
                        <!-- Internship report content will be loaded here -->
                    </div>
                </div>
                
                <div class="tab-content" id="evaluation-content">
                    <div id="evaluation-content-text">
                        <!-- Evaluation report content will be loaded here -->
                    </div>
                </div>
                
                <div class="comments-section">
                    <h4>Review Comments</h4>
                    <div class="comments-list" id="comments-list">
                        <!-- Comments will be loaded here -->
                        <div class="comment-item">
                            <div class="comment-meta">
                                <span class="comment-author">SCAD Office</span>
                                <span class="comment-date">2023-06-15 14:30</span>
                            </div>
                            <div class="comment-text">
                                This report was flagged because the weekly hours reported don't match the company's records.
                            </div>
                        </div>
                        <div class="comment-item">
                            <div class="comment-meta">
                                <span class="comment-author">Faculty Advisor</span>
                                <span class="comment-date">2023-06-18 09:15</span>
                            </div>
                            <div class="comment-text">
                                Student has been notified to provide clarification on the hours discrepancy.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Comment Form (only shown for flagged/rejected reports) -->
                    <div class="comment-form" id="comment-form" style="display: none;">
                        <textarea id="new-comment" placeholder="Add a comment explaining the reason for flagging/rejecting this report..."></textarea>
                        <button class="btn btn-primary btn-sm" id="submit-comment">Submit Comment</button>
                    </div>
                </div>
                
                <div class="attachments-section">
                    <h4>Attachments</h4>
                    <div class="attachments-list" id="attachments-list">
                        <!-- Attachments will be loaded here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="status-actions" style="display: none;">
                    <button class="btn btn-success" id="btn-accept-report"><i class="fas fa-check"></i> Accept</button>
                    <button class="btn btn-warning" id="btn-flag-report"><i class="fas fa-flag"></i> Flag</button>
                    <button class="btn btn-danger" id="btn-reject-report"><i class="fas fa-times"></i> Reject</button>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary close-modal">Close</button>
                    <button class="btn btn-primary" id="btn-download-report"><i class="fas fa-download"></i> Download Full Report</button>
                </div>
            </div>
        </div>
    </div>

    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="../../assets/js/auth.js"></script>
    <script src="../../assets/js/scad-reports.js"></script>
    <!-- Logout Confirmation Modal -->
<div class="modal" id="logout-modal">
    <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
            <h3>Confirm Logout</h3>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to log out?</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancel-logout">Cancel</button>
            <button class="btn btn-danger" id="confirm-logout">Log Out</button>
        </div>
    </div>
</div>
</body>
</html>